<!DOCTYPE html>
<html lang="et">
<head>
<meta charset="UTF-8">
<title>Oktoobri Kutse</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
.progress-bar{
  color:#fff;
  font-weight:bold;
  text-shadow:-1px -1px 0 #000,1px -1px 0 #000,-1px 1px 0 #000,1px 1px 0 #000;
}
table th,table td{text-align:center;}
</style>
</head>

<body class="bg-light">
<div class="container mt-4">

<!-- PEALKIRI -->
<div class="card shadow mb-3">
<div class="card-body text-center">
<h4>
Oktoobri Kutse â†’ <strong>PÃ¤evi reservini</strong> â†’
<span id="clock">00:00:00</span>
</h4>
<p id="morning" class="text-success fw-bold"></p>
</div>
</div>

<!-- TABID -->
<ul class="nav nav-tabs mb-3">
<li class="nav-item"><button class="nav-link active" data-bs-toggle="tab" data-bs-target="#progressTab">ðŸ“ˆ Edenemine</button></li>
<li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#todayTab">ðŸ§¹ TÃ¤na</button></li>
<li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#excelTab">ðŸ“Š Excel</button></li>
</ul>

<div class="tab-content">

<!-- EDENEMINE -->
<div class="tab-pane fade show active" id="progressTab">
<div class="card shadow mb-4">
<div class="card-body">

<label>Kogu periood</label>
<input id="totalDays" class="form-control mb-2" readonly>

<label>Tehtud (pÃ¤evades)</label>
<input id="doneDays" class="form-control mb-2" readonly>

<label>JÃ¤Ã¤nud</label>
<input id="leftDays" class="form-control mb-2" readonly>

<label>Tehtud aeg (kuud / pÃ¤evad / tunnid)</label>
<input id="elapsedTime" class="form-control mb-2" readonly>

<label>Progress</label>
<div class="progress mb-3" style="height:30px">
<div id="progressBar" class="progress-bar progress-bar-striped progress-bar-animated">0%</div>
</div>

<label>JÃ¤rgmine eesmÃ¤rk</label>
<input id="goal" class="form-control" readonly>

</div>
</div>
</div>

<!-- TÃ„NA -->
<div class="tab-pane fade" id="todayTab">
<div class="card shadow mb-4">
<div class="card-body text-center">
<h5>ðŸ§¹ TÃ¤nased korrapidajad</h5>
<p id="todayDate" class="fw-bold"></p>
<p><strong>Parem tuba:</strong> <span id="leftToday"></span></p>
<p><strong>Vasak tuba:</strong> <span id="rightToday"></span></p>
</div>
</div>
</div>

<!-- EXCEL -->
<div class="tab-pane fade" id="excelTab">
<div class="card shadow mb-4">
<div class="card-body">

<h5 class="text-center">ðŸ§¹ Parem tuba</h5>
<div class="table-responsive mb-4">
<table class="table table-bordered table-striped">
<thead><tr><th>KuupÃ¤ev</th><th>Nimi</th></tr></thead>
<tbody id="excelLeft"></tbody>
</table>
</div>

<h5 class="text-center">ðŸ§¹ Vasak tuba</h5>
<div class="table-responsive">
<table class="table table-bordered table-striped">
<thead><tr><th>KuupÃ¤ev</th><th>Nimi</th></tr></thead>
<tbody id="excelRight"></tbody>
</table>
</div>

</div>
</div>
</div>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
// ---------- ABI ----------
function daysBetween(a,b){
  const d1=new Date(a.getFullYear(),a.getMonth(),a.getDate());
  const d2=new Date(b.getFullYear(),b.getMonth(),b.getDate());
  return Math.round((d2-d1)/(1000*60*60*24));
}

// kuud/pÃ¤evad/tunnid
function elapsedYMDH(start, now){
  let s=new Date(start);
  let months=0;

  while(new Date(s.getFullYear(), s.getMonth()+1, s.getDate()) <= now){
    s.setMonth(s.getMonth()+1);
    months++;
  }

  const diffMs = now - s;
  const days = Math.floor(diffMs / (1000*60*60*24));
  const hours = Math.floor((diffMs % (1000*60*60*24)) / (1000*60*60));

  return {months, days, hours};
}

// ---------- ANDMED ----------
const progressStart=new Date(2025,9,13);
const progressEnd=new Date(2026,5,12);

const dutyStart=new Date(2026,0,6);
const dutyEnd=new Date(2026,5,12);

const leftNames=["SUDER","PISNENKO","TAMMUS","KASPAR PLANS","VIISPERT","NURMETALO", "KAAREL PLANS","MARK","KRiSTi"];
const rightNames=["KOSEMAA","KUUSEORG","LUMISTE","MÃœÃœR","PAASKIVI","PEETRIS","PINT","TAMME","JAKOBSON"];

// ---------- UPDATE ----------
function updateAll(){
const now=new Date();
const today=new Date(now.toLocaleString("en-US",{timeZone:"Europe/Tallinn"}));

// Kell
document.getElementById("clock").innerText=today.toLocaleTimeString("et-EE");

// Hommik
document.getElementById("morning").innerText =
(today.getHours()===7) ? "ðŸŒ… Tere hommikust!" : "";

// Edenemine
const total=daysBetween(progressStart,progressEnd);
const done=Math.max(0,daysBetween(progressStart,today));
const left=total-done;

document.getElementById("totalDays").value=total+" pÃ¤eva";
document.getElementById("doneDays").value=done+" pÃ¤eva";
document.getElementById("leftDays").value=left+" pÃ¤eva";

// LÃ¤bitud aeg
const e=elapsedYMDH(progressStart,today);
document.getElementById("elapsedTime").value=
`${e.months} kuud, ${e.days} pÃ¤eva, ${e.hours} tundi`;

const percent=Math.min(100,(done/total*100).toFixed(1));
document.getElementById("progressBar").style.width=percent+"%";
document.getElementById("progressBar").innerText=percent+"%";

const g50=Math.round(total*0.5);
const g75=Math.round(total*0.75);

let goal="";
if(done<g50) goal=`ðŸŽ¯ 50%: ${g50-done} pÃ¤eva`;
else if(done<g75) goal=`ðŸŽ¯ 75%: ${g75-done} pÃ¤eva`;
else if(done<total) goal=`ðŸŽ¯ 100%: ${total-done} pÃ¤eva`;
else goal="ðŸ† Valmis!";
document.getElementById("goal").value=goal;

// TÃ¤nased korrapidajad
const index=daysBetween(dutyStart,today);
document.getElementById("todayDate").innerText=today.toLocaleDateString("et-EE");
document.getElementById("leftToday").innerText=leftNames[index%leftNames.length];
document.getElementById("rightToday").innerText=rightNames[index%rightNames.length];
}

// ---------- EXCEL ----------
function fillExcel(){
let i=0;
for(let d=new Date(dutyStart); d<=dutyEnd; d.setDate(d.getDate()+1)){
document.getElementById("excelLeft").innerHTML+=
`<tr><td>${d.toLocaleDateString("et-EE")}</td><td>${leftNames[i%leftNames.length]}</td></tr>`;
document.getElementById("excelRight").innerHTML+=
`<tr><td>${d.toLocaleDateString("et-EE")}</td><td>${rightNames[i%rightNames.length]}</td></tr>`;
i++;
}
}

fillExcel();
updateAll();
setInterval(updateAll,1000);
</script>

</body>
</html>
