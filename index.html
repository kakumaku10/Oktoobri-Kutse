<!DOCTYPE html>
<html lang="et">
<head>
<meta charset="UTF-8">
<title>Edenemise j√§lgija</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
  body.dark { background-color: #121212; color: #eaeaea; }
  body.dark .card { background-color: #1e1e1e; }

  .title-container {
    display: flex; justify-content: center; align-items: center;
    font-size: 1.5rem; font-weight: bold; margin-bottom: 1rem;
    flex-wrap: wrap;
  }
  .title-container span { margin: 0 0.5rem; }

  .progress-bar {
    color: #fff; font-weight: bold;
    text-shadow: -1px -1px 0 #000,1px -1px 0 #000,-1px 1px 0 #000,1px 1px 0 #000;
  }

  body.dark label.form-label, body.dark input.form-control {
    color: #fff !important;
    text-shadow: -1px -1px 0 #000,1px -1px 0 #000,-1px 1px 0 #000,1px 1px 0 #000;
    background-color: #1e1e1e !important; border-color: #444 !important;
  }

  body:not(.dark) input.form-control { color: #000; background-color: #fff; border-color: #ced4da; text-shadow: none; }
  body:not(.dark) label.form-label { color: #000; text-shadow: none; }
</style>
</head>
<body class="bg-light">

<div class="container mt-5">
  <div class="card shadow-sm">
    <div class="card-body text-center">

      <div class="title-container">
        <span>Oktoobri Kutse</span>
        <span>‚Üí</span>
        <span id="titleProgress">P√§evi Reservini</span>
        <span>‚Üí</span>
        <span id="titleTime">00:00:00</span>
      </div>

      <p id="morningGreeting" class="text-success fw-bold mb-3"></p>

      <form class="text-start">
        <div class="mb-2">
          <label class="form-label"><strong>Kogu periood:</strong></label>
          <input type="text" id="totalDays" class="form-control" readonly>
        </div>
        <div class="mb-2">
          <label class="form-label"><strong>Tehtud:</strong></label>
          <input type="text" id="doneDays" class="form-control" readonly>
        </div>
        <div class="mb-2">
          <label class="form-label"><strong>J√§√§nud:</strong></label>
          <input type="text" id="leftDays" class="form-control" readonly>
        </div>

        <div class="mb-3">
          <label class="form-label"><strong>Progress:</strong></label>
          <div class="progress" style="height: 30px;">
            <div id="progressBar" class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width:0%">0%</div>
          </div>
        </div>

        <div class="mb-2">
          <label class="form-label"><strong>J√§rgmine eesm√§rk:</strong></label>
          <input type="text" id="nextGoal" class="form-control" readonly>
        </div>
      </form>

      <button class="btn btn-outline-secondary mt-3" onclick="toggleDarkMode()">üåô Tume re≈æiim</button>
      <div class="mt-3 text-center">
        <small class="text-muted">Uuendub automaatselt (Tallinna aeg)</small>
      </div>

    </div>
  </div>
</div>

<script>
function toggleDarkMode() {
  document.body.classList.toggle('dark');
}

// T√§pne p√§evade arv, ignoreerides kellaaega
function daysBetween(date1, date2){
  const d1 = new Date(date1.getFullYear(), date1.getMonth(), date1.getDate());
  const d2 = new Date(date2.getFullYear(), date2.getMonth(), date2.getDate());
  const msPerDay = 1000*60*60*24;
  return Math.max(0, Math.round((d2-d1)/msPerDay));
}

function calculateProgress(){
  const startDate = new Date(2025,9,13);  // 13. oktoober 2025
  const endDate = new Date(2026,5,12);    // 12. juuni 2026
  const now = new Date();
  const today = new Date(now.toLocaleString('en-US',{timeZone:'Europe/Tallinn'}));

  // Tallinna kellaaeg pealkirjas
  const hour = today.getHours(), min = today.getMinutes(), sec = today.getSeconds();
  document.getElementById('titleTime').textContent = `${hour.toString().padStart(2,'0')}:${min.toString().padStart(2,'0')}:${sec.toString().padStart(2,'0')}`;

  // Hommikune tervitus kell 7
  const greetingEl = document.getElementById('morningGreeting');
  const lastGreeting = localStorage.getItem('lastGreetingDate');
  const todayStr = today.getFullYear()+'-'+(today.getMonth()+1)+'-'+today.getDate();
  if(hour === 7 && lastGreeting !== todayStr){
    greetingEl.textContent = "üåÖ Tere hommikust! Uus p√§ev, uus edasiminek.";
    localStorage.setItem('lastGreetingDate', todayStr);
  } else if(hour !== 7){
    greetingEl.textContent = "";
  }

  // P√§evade arv
  const totalDays = daysBetween(startDate,endDate);
  const doneDays = daysBetween(startDate,today);
  const leftDays = Math.max(0,totalDays-doneDays);
  const percentage = Math.min(100, ((doneDays/totalDays)*100).toFixed(1));

  document.getElementById('totalDays').value = totalDays+' p√§eva';
  document.getElementById('doneDays').value = doneDays+' p√§eva';
  document.getElementById('leftDays').value = leftDays+' p√§eva';
  document.getElementById('progressBar').style.width = percentage+'%';
  document.getElementById('progressBar').textContent = percentage+'%';

  // J√§rgmine eesm√§rk √ºhes lahtris
  const goalEl = document.getElementById('nextGoal');
  const day50 = Math.round(totalDays*0.5);
  const day75 = Math.round(totalDays*0.75);
  const day100 = totalDays;

  if(doneDays < day50){
    goalEl.value = `üéØ 50% saavutamiseni: ${day50 - doneDays} p√§eva veel`;
  } else if(doneDays < day75){
    goalEl.value = `üéØ 75% saavutamiseni: ${day75 - doneDays} p√§eva veel`;
  } else if(doneDays < day100){
    goalEl.value = `üéØ 100% saavutamiseni: ${day100 - doneDays} p√§eva veel`;
  } else {
    goalEl.value = "üèÜ K√µik eesm√§rgid t√§idetud!";
  }
}

// Algne arvutus + uuendus iga sekundi tagant
calculateProgress();
setInterval(calculateProgress,1000);
</script>
</body>
</html>
